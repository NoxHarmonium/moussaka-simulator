/*! moussaka-simulator - v0.0.1 - 2014-10-15 */(function(a,b){var c=!("function"!=typeof define||!define.amd),d="object"==typeof exports,e=d?require:function(a){throw new Error("uRequire detected missing dependency: '"+a+"' - in a non-nodejs runtime. All it's binding variables were 'undefined'.")},f=function(a,c,f){var g,h,i;return function(a){function b(a,b){return u.call(a,b)}function c(a,b){var c,d,e,f,g,h,i,j,k,l,m,n=b&&b.split("/"),o=s.map,p=o&&o["*"]||{};if(a&&"."===a.charAt(0))if(b){for(n=n.slice(0,n.length-1),a=a.split("/"),g=a.length-1,s.nodeIdCompat&&w.test(a[g])&&(a[g]=a[g].replace(w,"")),a=n.concat(a),k=0;k<a.length;k+=1)if(m=a[k],"."===m)a.splice(k,1),k-=1;else if(".."===m){if(1===k&&(".."===a[2]||".."===a[0]))break;k>0&&(a.splice(k-1,2),k-=2)}a=a.join("/")}else 0===a.indexOf("./")&&(a=a.substring(2));if((n||p)&&o){for(c=a.split("/"),k=c.length;k>0;k-=1){if(d=c.slice(0,k).join("/"),n)for(l=n.length;l>0;l-=1)if(e=o[n.slice(0,l).join("/")],e&&(e=e[d])){f=e,h=k;break}if(f)break;!i&&p&&p[d]&&(i=p[d],j=k)}!f&&i&&(f=i,h=j),f&&(c.splice(0,h,f),a=c.join("/"))}return a}function d(b,c){return function(){return n.apply(a,v.call(arguments,0).concat([b,c]))}}function e(a){return function(b){return c(b,a)}}function f(a){return function(b){q[a]=b}}function j(c){if(b(r,c)){var d=r[c];delete r[c],t[c]=!0,m.apply(a,d)}if(!b(q,c)&&!b(t,c))throw new Error("No "+c);return q[c]}function k(a){var b,c=a?a.indexOf("!"):-1;return c>-1&&(b=a.substring(0,c),a=a.substring(c+1,a.length)),[b,a]}function l(a){return function(){return s&&s.config&&s.config[a]||{}}}var m,n,o,p,q={},r={},s={},t={},u=Object.prototype.hasOwnProperty,v=[].slice,w=/\.js$/;o=function(a,b){var d,f=k(a),g=f[0];return a=f[1],g&&(g=c(g,b),d=j(g)),g?a=d&&d.normalize?d.normalize(a,e(b)):c(a,b):(a=c(a,b),f=k(a),g=f[0],a=f[1],g&&(d=j(g))),{f:g?g+"!"+a:a,n:a,pr:g,p:d}},p={require:function(a){return d(a)},exports:function(a){var b=q[a];return"undefined"!=typeof b?b:q[a]={}},module:function(a){return{id:a,uri:"",exports:q[a],config:l(a)}}},m=function(c,e,g,h){var i,k,l,m,n,s,u=[],v=typeof g;if(h=h||c,"undefined"===v||"function"===v){for(e=!e.length&&g.length?["require","exports","module"]:e,n=0;n<e.length;n+=1)if(m=o(e[n],h),k=m.f,"require"===k)u[n]=p.require(c);else if("exports"===k)u[n]=p.exports(c),s=!0;else if("module"===k)i=u[n]=p.module(c);else if(b(q,k)||b(r,k)||b(t,k))u[n]=j(k);else{if(!m.p)throw new Error(c+" missing "+k);m.p.load(m.n,d(h,!0),f(k),{}),u[n]=q[k]}l=g?g.apply(q[c],u):void 0,c&&(i&&i.exports!==a&&i.exports!==q[c]?q[c]=i.exports:l===a&&s||(q[c]=l))}else c&&(q[c]=g)},g=h=n=function(b,c,d,e,f){if("string"==typeof b)return p[b]?p[b](c):j(o(b,c).f);if(!b.splice){if(s=b,s.deps&&n(s.deps,s.callback),!c)return;c.splice?(b=c,c=d,d=null):b=a}return c=c||function(){},"function"==typeof d&&(d=e,e=f),e?m(a,b,c,d):setTimeout(function(){m(a,b,c,d)},4),n},n.config=function(a){return n(a)},g._defined=q,i=function(a,c,d){c.splice||(d=c,c=[]),b(q,a)||b(r,a)||(r[a]=[a,c,d])},i.amd={jQuery:!0}}(),i("almond",function(){}),i("three",[],function(){return d?e("three"):"undefined"!=typeof c?c:e("three")}),i("moussaka-client-js",[],function(){return d?e("moussaka-client-js"):"undefined"!=typeof f?f:e("moussaka-client-js")}),i("simulator",["require","exports","module","three","moussaka-client-js"],function(a,c,d){"use strict";var e=a("three"),f=a("moussaka-client-js"),g=function(a){this.client=new f(a),this.rotateSpeed=this.client.registerVar("rotateSpeed",.05)};g.prototype.startGame=function(){var a=document.querySelector("div#renderer");this.scene=new e.Scene,this.camera=new e.PerspectiveCamera(75,a.offsetWidth/a.offsetWidth,.1,1e3),this.renderer=new e.WebGLRenderer,this.renderer.setSize(a.offsetWidth,a.offsetWidth),a.appendChild(this.renderer.domElement);var b=new e.BoxGeometry(1,1,1),c=new e.MeshBasicMaterial({color:65280});this.cube=new e.Mesh(b,c),this.scene.add(this.cube),this.camera.position.z=5,this.render()},g.prototype.render=function(){b.requestAnimationFrame(this.render.bind(this)),this.renderer.render(this.scene,this.camera),this.cube.rotation.x+=this.rotateSpeed.value,this.cube.rotation.y+=this.rotateSpeed.value};var h=new g({deviceName:"Moussaka Client Example",apiKey:"xxxx-xxxx-xxxx-xxxx-xxxx",projectId:"xxxx-xxxx-xxxx-xxxx-xxxx",projectVersion:"v1"});return h.startGame(),d.exports=h,d.exports}),i("jquery",[],function(){return d?e("jquery"):"undefined"!=typeof a?a:e("jquery")}),i("utils",["require","exports","module"],function(a,c,d){"use strict";return d.exports.getUrlVars=function(){for(var a,c=[],d=b.location.href.slice(b.location.href.indexOf("?")+1).split("&"),e=0;e<d.length;e++)a=d[e].split("="),c.push(a[0]),c[a[0]]=a[1];return c},d.exports}),i("errorHelp",["require","exports","module"],function(a,b,c){"use strict";return c.exports={"Origin is not allowed by Access-Control-Allow-Origin":'You cannot use the API by opening the HTML file locally. You need to serve it from somewhere. If you have grunt installed you run "grunt serve" from the project root.'},c.exports}),i("dom",["require","exports","module","jquery","./simulator","./utils","./errorHelp"],function(a,b,c){"use strict";var d,e,f,g=a("jquery"),h=a("./simulator"),i=a("./utils"),j=a("./errorHelp"),k=function(a){d.parent().removeClass("hidden"),e.text(a.message);for(var b in j)if(-1!==a.message.indexOf(b)){f.text(j[b]),f.parent().removeClass("hidden");break}},l=function(){var a=i.getUrlVars();h.client.deviceName=g("#txtDeviceName").val(a.deviceName||"Test Device"),h.client.apiKey=g("#txtApiKey").val(a.apiKey||""),h.client.projectId=g("#txtProjectId").val(a.projectId||""),h.client.projectVersion=g("#txtProjectVersion").val(a.projectVersion||""),h.client.serverUrl=g("#txtServerUrl").val(a.serverUrl||"http://localhost:3000/"),h.client.pollInterval=g("#txtPollInterval").val(a.pollInterval||1e3),a.connectNow&&m()},m=function(){h.client.deviceName=g("#txtDeviceName").val(),h.client.apiKey=g("#txtApiKey").val(),h.client.projectId=g("#txtProjectId").val(),h.client.projectVersion=g("#txtProjectVersion").val(),h.client.serverUrl=g("#txtServerUrl").val(),h.client.pollInterval=g("#txtPollInterval").val(),f.parent().addClass("hidden"),d.parent().addClass("hidden");try{h.client.connect()}catch(a){k(a)}g("control-container").slideUp("fast")},n=function(){try{h.client.disconnect()}catch(a){k(a)}},o=function(a){d=a("div#errorbox > h5"),e=a("div#errorbox > p"),f=a("div#errorhelp > p"),a("div.container").find(".accordion-toggle").click(function(){a(this).toggleClass("toggled"),a(this).nextUntil(".accordion-content").next().slideToggle("fast")}),a(".connect-button").click(function(){console.log("Connecting..."),m()}),a(".disconnect-button").click(function(){console.log("Disconnecting..."),n()}),l()};return g(document).ready(o),h.client.on("error",k),c.exports={},c.exports}),i("index",["require","exports","module","./simulator","./dom"],function(a,b,c){"use strict";a("./simulator"),a("./dom");return c.exports}),h("index")};return c?define(["jquery","three","moussaka-client-js"],f):d?module.exports=f(require("jquery"),require("three"),require("moussaka-client-js")):f("undefined"!=typeof $?$:void 0,"undefined"!=typeof THREE?THREE:void 0,"undefined"!=typeof MoussakaClient?MoussakaClient:void 0)}).call(this,"object"==typeof exports?global:window,"object"==typeof exports?global:window);